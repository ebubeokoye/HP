{% extends "layout.html" %}
{% block body %}

    <div style="background-color: #004aad; color: white; width: 100%; height: 50px;"> < add property </div>

    <div class="housing-agent-additem-form">
        <form action="agent_housing_listing" method="post" enctype="multipart/form-data" style="width: 50%; margin: auto; border: 2px solid green;">
            <p>
                <p>Category</p>
                <select name="category" class="house-agent-additem-selectmenu">
                    <option disabled selected value=""></option>
                    <option name="bungalow">Bungalow</option>
                    <option name="2 Bedroom Flat">2 Bedroom Flat</option>
                    <option name="3 Bedroom Flat">3 Bedroom Flat</option>
                    <option name="A room self con">A room self con</option>
                </select>
                <!-- this is the option for them to update their category list -->
                <p style="color: green;"> + Add category </p>
            </p>
    
            <p style="height: 40px;">
                <p>Property Location</p>
                <input autocomplete="off" name="property location" type="text" class="house-agent-additem-input">
            </p>
    
            <p style="height: 40px;">
                <p>Property Address</p>
                <!-- put a measure inplace here eg with javascript to make sure they dont type numbers -->
                <input autocomplete="off" name="property location" type="text"  class="house-agent-additem-input">
            </p>
    
            <p style="height: 40px;">
                <p>Price</p>
                <!-- look for how to put money amount in a form -->
                <input autocomplete="off" name="property location" type="number"  class="house-agent-additem-input">
            </p>

            <p>Upload property image</p>
            <!-- let it have the same width as other inputs -->
            <div style="height: 200px; width: 400px; margin: auto; border: 1px solid lightblue;">
                <p style="height: 200px; width: 70%; margin: auto;">
                    <!-- look for how to put money amount in a form -->
                    <input autocomplete="off" name="picture" type="file" style="height: 100%; width: 100%; margin: auto;
                    border: 2px solid green; background-color: whitesmoke; opacity: 1;">
                </p>

                <div style="position: relative; margin-top: 15px; width: 400px; height: 200px;
                    border-radius: 15px; background-color: #e4e7eb;">                 
                    <input type="file" accept=".jpg, .png" style="position: absolute; left: 0; top: 0;
                        width: 800px; height: 400px; border-radius: 15px; opacity: 0;"
                        id="coverimage-fileInput">
                    <img src="land-icon.jpg" style="position: absolute; left: 0; top: 0; width: 800px;
                        height: 400px; display: none; object-fit: cover;" id="imagePreview">
                </div>
            </div>
            <div id="error-message"></div>

            <p style="height: 40px;">
                <p>Description/house facilities eg water supply</p>
                <!-- edit to allow numbers and texts -->
                <input autocomplete="off" name="property location" type="text"  class="house-agent-additem-input">
            </p>
    
            <input type="submit" value="Add Item" class="housing-agent-additem-form-button">

        </form>
    </div>

    <div class="agent-homepage-navlist-container">
        <div class="user-homepage-navlist-subdiv">
            <a href="housing_agent_homepage" class="agent-homepage-navlist-link">
                <img src="{{url_for ('static', filename='user-home-icon.jpg') }}" class="users-homepage-navicon">
            </a>
            <div style="color: black; position: absolute;">Orders</div>
            <a href="form_to_add_item_housingagent" class="agent-homepage-navlist-link">
                <img src="{{url_for ('static', filename='land-icon.jpg') }}" class="users-homepage-navicon">
            </a>
            <div style="color: black; position: absolute;">Land listing</div>
            <a href="agent_rent_listing" class="agent-homepage-navlist-link">
                <img src="{{url_for ('static', filename='user-rent-icon.jpg') }}" class="users-homepage-navicon">
            </a>
            <div style="color: black; position: absolute;">Inbox</div>
            <a href="insights_page_housingagent" class="agent-homepage-navlist-link">
                <img src="{{url_for ('static', filename='user-houseitems-icon.jpg') }}" class="users-homepage-navicon">
            </a>
            <div style="color: black; position: absolute;">Appointments</div>
            <a href="insights_page_housingagent" class="agent-homepage-navlist-link">
                <img src="{{url_for ('static', filename='user-account-icon.jpg') }}" class="users-homepage-navicon">
            </a>
            <div style="color: black; position: absolute;">Account</div>
        </div>
        
    </div>

    
    <script>


let logoimagefileInput = document.getElementById("logoimage-fileInput");
        let logoImgPreview = document.getElementById("logoImgPreview");
        let logoErrorMessage = document.getElementById("logoerror-message");

        logoimagefileInput.addEventListener('change', function() {
            logoErrorMessage.style.display = "none";
    
            if (logoimagefileInput.files.length > 0) {
                const file = logoimagefileInput.files[0];

                const reader = new FileReader();
                reader.onload = function(e) { 
                    logoImgPreview.src = e.target.result;
                    logoImgPreview.style.display = "block";
                };
                reader.readAsDataURL(file);
            }
        });

        function showError(message) {
            logoErrorMessage.textContent = message;
            logoErrorMessage.style.display = "block";
        }

        // ---------------------------------------------------------------------------------------------------------

        let coverimagefileInput = document.getElementById("coverimage-fileInput");
        let imagePreview = document.getElementById("imagePreview");
        let errorMessage = document.getElementById("error-message");

        coverimagefileInput.addEventListener('change', function() {
            errorMessage.style.display = "none";
    
            if (coverimagefileInput.files.length > 0) {
                const file = coverimagefileInput.files[0];

                const fileType = file.type;
                if (fileType !== 'image/jpg' && fileType !== 'image/png') {
                    showError('Please select only JPG or PNG images.');
                    coverimagefileInput.value = '';
                    return;
                }

                if (file.size > 1048576) {
                    showError('File size exceeds 1MB, Please choose a smaller image');
                    coverimagefileInput.value = '';
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(e) { 
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = "block";
                };
                reader.readAsDataURL(file);
            }
        });

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = "block";
        }
    </script>
{% endblock %}